%html
  %head
    %title
      Xunit Test Results - For:
      = doc.elements["testsuite"].attribute("name")
    :css
      .test-failure a.test-status {
          color: red;
      }
      .test-error a.test-status {
          color: red;
      }
      .test-passed p.test-status {
          color: green;
      }
      .test-skipped a.test-status {
          color: #00CCFF;
      }
      a.test-status {
          text-transform: capitalize;
      }
      p.test-status {
          text-transform: capitalize;
      }
      tr.test-message pre {
          width: 930px;
          overflow: auto;
      }
    :javascript
      $(document).ready(function() {
          $("a.test-status").click(function() {
              $(this).parents("tr").next("tr.test-message").toggle();
              return false;
          });
          $("tr.test-message").hide();
      });
  %body
    %h1.divided
      Results for test
      = uuid
      = link_to "(Raw XML)", "#{uuid}.xml"
    .testcases
      - tests = doc.elements.to_a('testsuite/testcase').group_by{|el| el.attribute("classname").to_s()}
      - tests.keys.sort.each do |class_name|
        %h2= class_name
        %table{:class => "data box"}
          %thead
            %tr
              %th Test name
              %th Running time
              %th State
          %tbody
            - tests[class_name].each do |test_run|
              - if not test_run.has_elements?
                - type = "passed"
              - else
                - type = test_run.elements[1].name
              %tr{:class => "test-"+type}
                %td
                  %p= test_run.attribute("name").to_s()
                %td
                  %p= test_run.attribute("time").to_s()
                %td
                  - if type == "passed"
                    %p{:class => "test-status"}= type
                  - else
                    %a{:class => "test-status", :href => "javascript:void(0)"}= type
              - if type != "passed"
                %tr{:class => "test-message"}
                  %td{:colspan => 3}
                    %pre= test_run.elements[1].cdatas()
